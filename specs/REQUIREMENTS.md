# Yumeminture Snap 要件定義書

## 1. システム概要

### 1.1 プロジェクト名
Yumeminture Snap（&[🏢]s!:Snap）

### 1.2 コンセプト
組織を超えた人脈形成プラットフォーム - 組織と組織がつながり、組織間のメンバーが写真を通じて繋がるソーシャルネットワーキングサービス

### 1.3 ビジョン
ビジネスにおける偶発的な出会いと継続的な関係構築を支援し、組織の壁を越えた価値あるつながりを創出する

## 2. 機能要件

### 要件2.1: 認証・認可機能

#### 要件2.1.1: ユーザー認証
- Google OAuthによるソーシャルログイン機能を提供する
- 認証されていないユーザーはログインページにリダイレクトする
- ログアウト機能を提供する

#### 要件2.1.2: セッション管理
- Supabase Authを使用してセッション管理を行う
- セッションの有効期限を適切に管理する

### 要件2.2: 組織管理機能

#### 要件2.2.1: 組織作成
- 認証済みユーザーは新しい組織を作成できる
- 組織名と説明を設定できる
- 作成者は自動的に管理者権限を持つ

#### 要件2.2.2: 組織一覧表示
- すべての組織を一覧表示できる
- 組織名で検索できる
- 各組織のメンバー数を表示する

#### 要件2.2.3: 組織詳細表示
- 組織の基本情報（名前、説明）を表示する
- 組織のメンバー一覧を表示する
- メンバーのアバターと名前を表示する

#### 要件2.2.4: 組織編集（管理者権限）
- 組織管理者は組織情報を編集できる
- 組織管理者は組織を削除できる
- 管理者権限の確認を行う

### 要件2.3: メンバーシップ管理機能

#### 要件2.3.1: 参加申請
- ユーザーは1つの組織にのみ所属できる
- 組織への参加申請を送信できる
- 申請時のステータスは「pending」となる

#### 要件2.3.2: 申請承認・却下（管理者権限）
- 組織管理者は参加申請を承認または却下できる
- 承認時、申請者に通知を送信する
- 却下時、申請者に通知を送信する

#### 要件2.3.3: メンバー管理（管理者権限）
- 組織管理者はメンバーの権限を変更できる（admin/member）
- 組織管理者はメンバーをキック（削除）できる
- 管理者は最低1人必要とする

### 要件2.4: 友達機能

#### 要件2.4.1: 友達関係の確立
- 写真に一緒にタグ付けされることで自動的に友達になる
- 友達関係は双方向の関係として管理する
- 重複する友達関係は作成しない

#### 要件2.4.2: 友達一覧表示
- 自分の友達一覧を表示できる
- 他のユーザーの友達一覧を表示できる（友達の場合のみ）
- 友達のプロフィール情報を表示する

#### 要件2.4.3: 友達関係の解除
- ユーザーは友達関係を解除できる
- 解除は即座に反映される

### 要件2.5: 写真機能

#### 要件2.5.1: 写真アップロード
- 認証済みユーザーは写真をアップロードできる
- モバイルではカメラ撮影またはファイル選択が可能
- 写真に説明文を追加できる

#### 要件2.5.2: ユーザータグ付け
- アップロード時に写真内のユーザーをタグ付けできる
- すべてのユーザーから選択可能（友達に限定しない）
- タグ付けされたユーザー同士は自動的に友達になる

#### 要件2.5.3: 写真ギャラリー
- 自分がアップロードした写真を一覧表示できる
- 自分がタグ付けされた写真を一覧表示できる
- サムネイル表示で効率的に閲覧できる

#### 要件2.5.4: 写真削除
- アップロードした本人のみ写真を削除できる
- 削除時は確認ダイアログを表示する

### 要件2.6: コミュニケーション状態管理

#### 要件2.6.1: ステータス設定
- 4種類のステータスタイプを設定できる：
  - In Office（出社中）
  - At Social Event（懇親会参加中）
  - Available（対応可能）
  - Busy（取り込み中）
- カスタムメッセージを設定できる（最大200文字）
- 有効期限を設定できる（時間単位）

#### 要件2.6.2: ステータス表示
- 自分のステータスを表示・更新できる
- 友達のステータスを表示できる
- 友達の友達のステータスまで表示できる

### 要件2.7: ネットワーク可視化

#### 要件2.7.1: ネットワーク図表示
- 自分を中心としたネットワーク図を表示する
- 友達の友達までの関係を可視化する
- 所属組織情報をバッジで表示する

#### 要件2.7.2: インタラクティブ操作
- ズーム・パン操作が可能
- ノードクリックでプロフィールページへ遷移
- 関係性の種類を視覚的に区別（線の色・スタイル）

### 要件2.8: タイムライン機能

#### 要件2.8.1: アクティビティ表示
- 自分と友達のアクティビティを時系列で表示する
- 友達の友達のアクティビティも表示する
- アクティビティタイプ：
  - 友達追加
  - 写真アップロード
  - 組織参加
  - 組織作成
  - ステータス変更

#### 要件2.8.2: アクティビティ詳細
- 各アクティビティに関連する情報を表示
- ユーザーのアバターと現在のステータスを表示
- タイムスタンプを表示

### 要件2.9: プロフィール機能

#### 要件2.9.1: プロフィール表示
- ユーザーの基本情報を表示（名前、アバター）
- 所属組織を表示
- 友達数と写真数を表示

#### 要件2.9.2: プロフィール編集
- 自分の名前を編集できる
- アバター画像をアップロード・変更できる
- プロフィール情報の更新は即座に反映される

### 要件2.10: 通知機能

#### 要件2.10.1: 通知タイプ
- 組織参加申請通知
- 申請承認/却下通知
- 友達追加通知
- 写真タグ付け通知

#### 要件2.10.2: 通知配信
- リアルタイムで通知を受信する
- 未読通知数を表示する
- 通知をクリックで既読にする

#### 要件2.10.3: 通知UI
- ヘッダーに通知ベルアイコンを表示
- 未読通知がある場合はバッジで数を表示
- クリックでドロップダウンメニューを表示
- 通知一覧から詳細へ遷移可能

### 要件2.11: UI/UX改善

#### 要件2.11.1: ログインページ
- 機能紹介デモの実装（4つのタブ）
  - Join Organization（組織参加）
  - Capture Photos（写真で友達になる）
  - Network Visualization（ネットワーク可視化）
  - Real-time Status（リアルタイムステータス）
- 背景アニメーション（DarkVeil）
- タイトルのグラデーションアニメーション

#### 要件2.11.2: ナビゲーション
- ハンバーガーメニューによる統一されたナビゲーション
- PC/SP両方で同じ体験を提供
- Sheet UIによるスライドメニュー
- アクセシビリティ対応（スクリーンリーダー向けタイトル）

### 要件2.12: SEO/メタデータ

#### 要件2.12.1: メタデータ設定
- Open Graph対応
- Twitter Card対応
- 動的なページタイトル
- 適切なdescriptionとkeywords

#### 要件2.12.2: PWA対応
- manifest.json設定
- アプリアイコン設定
- テーマカラー設定

#### 要件2.12.3: 検索エンジン最適化
- robots.txt設定
- サイトマップ自動生成
- 構造化データ対応

## 3. 非機能要件

### 要件3.1: パフォーマンス

#### 要件3.1.1: レスポンスタイム
- ページ読み込み時間は3秒以内
- API応答時間は1秒以内

#### 要件3.1.2: スケーラビリティ
- 同時接続ユーザー数1,000人に対応
- データベースクエリの最適化（インデックス設定）

### 要件3.2: セキュリティ

#### 要件3.2.1: 認証・認可
- すべてのAPIエンドポイントで認証を必須とする
- Row Level Security（RLS）によるデータアクセス制御

#### 要件3.2.2: データ保護
- HTTPS通信の強制
- SQLインジェクション対策
- XSS対策

### 要件3.3: ユーザビリティ

#### 要件3.3.1: レスポンシブデザイン
- デスクトップ、タブレット、モバイルに対応
- タッチ操作の最適化

#### 要件3.3.2: アクセシビリティ
- WCAG 2.1 Level AAに準拠
- キーボードナビゲーション対応

### 要件3.4: 可用性

#### 要件3.4.1: システム稼働率
- 99.9%以上の稼働率を目標とする
- 計画的メンテナンス時の事前通知

### 要件3.5: 保守性

#### 要件3.5.1: コード品質
- TypeScriptによる型安全性の確保
- ESLint/Prettierによるコード規約の統一
- コンポーネントの再利用性を重視

#### 要件3.5.2: ドキュメント
- API仕様書の整備
- コンポーネントのStorybook対応
- CLAUDE.mdによるAI向け開発ガイドライン

## 4. 技術要件

### 要件4.1: 技術スタック
- フロントエンド: Next.js 15 (App Router)
- 言語: TypeScript
- スタイリング: Tailwind CSS v4
- UIコンポーネント: shadcn/ui
- データベース: Supabase (PostgreSQL)
- ORM: Drizzle ORM
- 認証: Supabase Auth
- ストレージ: Supabase Storage
- 状態管理: React Server Components + Server Actions

### 要件4.2: ブラウザサポート
- Chrome (最新版)
- Firefox (最新版)
- Safari (最新版)
- Edge (最新版)
- モバイルブラウザ (iOS Safari, Chrome)

### 要件4.3: 開発環境
- Node.js 18以上
- Bun (パッケージマネージャー)
- Git (バージョン管理)
- Lefthook (Git hooks)

## 5. 制約事項

### 要件5.1: ユーザー制約
- 1ユーザーは1組織のみ所属可能
- 組織には最低1人の管理者が必要

### 要件5.2: データ制約
- 写真のファイルサイズは最大10MB
- ステータスメッセージは最大200文字
- 組織名は一意である必要がある

### 要件5.3: システム制約
- Supabaseの無料プランの制限内で動作
- ネットワーク可視化は友達の友達まで

